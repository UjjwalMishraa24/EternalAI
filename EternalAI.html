<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eternal AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; /* Fallback color */
        }
        h1, h2 {
            font-family: 'Playfair Display', serif;
        }
        #canvas-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: linear-gradient(135deg, #1e1b4b, #4c1d95, #a78bfa);
        }
        main {
            position: relative;
            z-index: 10;
        }
        .card {
            background: rgba(17, 24, 39, 0.4);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }
        .input-field {
            background-color: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.15);
            transition: all 0.3s ease;
        }
        .input-field:focus, .input-field:focus-within {
            outline: none;
            border-color: rgba(196, 181, 253, 0.5);
            background-color: rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 0 3px rgba(196, 181, 253, 0.1);
        }
        .btn-divine {
            background: linear-gradient(to right, #8b5cf6, #a78bfa);
            color: white;
            transition: all 0.3s ease-in-out;
            text-shadow: 0 1px 3px rgba(0,0,0,0.15);
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.2);
        }
        .btn-divine:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.35);
        }
        .btn-audio {
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #d1d5db;
            transition: all 0.3s ease;
        }
        .btn-audio:hover {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
        }
        .btn-audio.active {
            background-color: #a78bfa;
            color: white;
            border-color: #a78bfa;
        }
        #response-container p {
            white-space: pre-wrap;
            word-wrap: break-word;
            animation: fade-in 0.8s ease-in-out;
        }
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .loader {
            border: 4px solid rgba(255,255,255,0.2);
            border-top: 4px solid #c4b5fd;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            animation: spin 1.2s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='2' stroke='%23d1d5db' class='w-6 h-6'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M19.5 8.25l-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 1.5em;
        }
        .title-gradient {
            background: -webkit-linear-gradient(45deg, #ede9fe, #c4b5fd, #a78bfa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
    </style>
</head>
<body class="text-white">
    
    <canvas id="canvas-bg"></canvas>

    <main class="w-full max-w-5xl mx-auto flex items-center min-h-screen p-4">
        <div class="card grid md:grid-cols-2 gap-8 md:gap-12 p-8 md:p-12 w-full">
            
            <!-- Left Column: Controls -->
            <div class="flex flex-col justify-center">
                <div class="text-center md:text-left mb-8">
                    <h1 class="text-5xl md:text-6xl font-bold title-gradient">Eternal AI</h1>
                    <p class="text-gray-300 mt-4 text-lg">Timeless wisdom for the modern mind.</p>
                </div>

                <form id="prompt-form" class="space-y-6">
                    <div>
                        <label for="wisdom-source" class="block text-sm font-medium text-gray-300 mb-2">Select a Perspective:</label>
                        <select id="wisdom-source" name="wisdom-source" class="w-full px-4 py-3 text-white rounded-lg input-field">
                            <option value="General" class="text-black">Eternal AI</option>
                            <option value="Hinduism" class="text-black">Hinduism</option>
                            <option value="Islam" class="text-black">Islam</option>
                            <option value="Sikhism" class="text-black">Sikhism</option>
                            <option value="Christianity" class="text-black">Christianity</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="prompt-input" class="block text-sm font-medium text-gray-300 mb-2">Inscribe your query:</label>
                        <textarea id="prompt-input" placeholder="Ask a question about life, purpose, or peace..." rows="4" class="w-full p-4 text-lg text-white rounded-lg input-field resize-none"></textarea>
                    </div>

                    <div class="flex items-center space-x-4">
                        <button type="submit" class="w-full py-4 font-semibold text-lg rounded-lg btn-divine">
                            <i class="fa-solid fa-wand-magic-sparkles mr-2"></i> Receive Wisdom
                        </button>
                        <button type="button" id="audio-toggle" class="p-4 rounded-lg btn-audio" title="Toggle Audio">
                            <i id="audio-icon" class="fa-solid fa-volume-xmark"></i>
                        </button>
                    </div>
                </form>
            </div>

            <!-- Right Column: Response -->
            <div class="bg-black/20 rounded-xl p-6 flex flex-col min-h-[400px] md:min-h-full">
                <h2 class="text-2xl font-bold text-gray-200 mb-4 border-b border-white/10 pb-3">The Oracle Responds:</h2>
                <div id="response-area" class="flex-grow flex items-center justify-center">
                    <div id="loader" class="hidden loader"></div>
                    <div id="response-container" class="text-gray-200 text-lg leading-relaxed w-full max-h-[450px] overflow-y-auto">
                        <p id="placeholder-text" class="text-gray-400 text-center">Awaiting your query...</p>
                    </div>
                    <div id="error-message" class="hidden text-red-400 font-semibold text-center">
                        <p>An error occurred. The connection to the eternal is unstable.</p>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <script>
        // --- Dynamic Background Canvas ---
        const canvas = document.getElementById('canvas-bg');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let particlesArray;
        class Particle {
            constructor(x, y, directionX, directionY, size, color) {
                this.x = x; this.y = y; this.directionX = directionX; this.directionY = directionY; this.size = size; this.color = color;
            }
            draw() {
                ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false); ctx.fillStyle = 'rgba(237, 233, 254, 0.5)'; ctx.fill();
            }
            update() {
                if (this.x > canvas.width || this.x < 0) { this.directionX = -this.directionX; }
                if (this.y > canvas.height || this.y < 0) { this.directionY = -this.directionY; }
                this.x += this.directionX; this.y += this.directionY; this.draw();
            }
        }
        function init() {
            particlesArray = []; let numberOfParticles = (canvas.height * canvas.width) / 9000;
            for (let i = 0; i < numberOfParticles; i++) {
                let size = (Math.random() * 2) + 1; let x = (Math.random() * ((innerWidth - size * 2) - (size * 2)) + size * 2); let y = (Math.random() * ((innerHeight - size * 2) - (size * 2)) + size * 2);
                let directionX = (Math.random() * .4) - .2; let directionY = (Math.random() * .4) - .2; particlesArray.push(new Particle(x, y, directionX, directionY, size));
            }
        }
        function connect() {
            let opacityValue = 1;
            for (let a = 0; a < particlesArray.length; a++) {
                for (let b = a; b < particlesArray.length; b++) {
                    let distance = ((particlesArray[a].x - particlesArray[b].x) * (particlesArray[a].x - particlesArray[b].x)) + ((particlesArray[a].y - particlesArray[b].y) * (particlesArray[a].y - particlesArray[b].y));
                    if (distance < (canvas.width / 7) * (canvas.height / 7)) {
                        opacityValue = 1 - (distance / 20000); ctx.strokeStyle = 'rgba(196, 181, 253,' + opacityValue + ')'; ctx.lineWidth = 1;
                        ctx.beginPath(); ctx.moveTo(particlesArray[a].x, particlesArray[a].y); ctx.lineTo(particlesArray[b].x, particlesArray[b].y); ctx.stroke();
                    }
                }
            }
        }
        function animate() {
            requestAnimationFrame(animate); ctx.clearRect(0, 0, innerWidth, innerHeight);
            for (let i = 0; i < particlesArray.length; i++) { particlesArray[i].update(); }
            connect();
        }
        window.addEventListener('resize', function() { canvas.width = innerWidth; canvas.height = innerHeight; init(); });
        init(); animate();

        // --- UI & API Interaction ---
        const promptForm = document.getElementById('prompt-form');
        const promptInput = document.getElementById('prompt-input');
        const wisdomSource = document.getElementById('wisdom-source');
        const responseContainer = document.getElementById('response-container');
        const placeholderText = document.getElementById('placeholder-text');
        const loader = document.getElementById('loader');
        const errorMessage = document.getElementById('error-message');
        const audioToggleButton = document.getElementById('audio-toggle');
        const audioIcon = document.getElementById('audio-icon');

        let isAudioEnabled = false;
        const synth = window.speechSynthesis;

        // --- Audio Controls ---
        audioToggleButton.addEventListener('click', () => {
            isAudioEnabled = !isAudioEnabled;
            audioToggleButton.classList.toggle('active', isAudioEnabled);
            if (isAudioEnabled) {
                audioIcon.className = 'fa-solid fa-volume-high';
            } else {
                audioIcon.className = 'fa-solid fa-volume-xmark';
                synth.cancel(); // Stop any ongoing speech
            }
        });

        function speak(text) {
            if (isAudioEnabled && text) {
                const utterance = new SpeechSynthesisUtterance(text);
                // Optional: Find a more suitable voice if available
                const voices = synth.getVoices();
                // utterance.voice = voices.find(voice => voice.name === 'Google UK English Female');
                utterance.pitch = 1;
                utterance.rate = 0.9;
                synth.speak(utterance);
            }
        }
        
        // --- Form Submission ---
        promptForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const prompt = promptInput.value.trim();
            const perspective = wisdomSource.value;

            if (!prompt) return;

            // Stop any previous speech before starting a new request
            synth.cancel();

            placeholderText.classList.add('hidden');
            responseContainer.innerHTML = '';
            errorMessage.classList.add('hidden');
            loader.classList.remove('hidden');

            try {
                let systemPrompt = "";
                switch (perspective) {
                    case "Hinduism":
                        systemPrompt = "You are Lord Krishna. Your answers must be based on the wisdom of the Bhagavad Gita. When appropriate, quote relevant verses from the Gita to support your answer. Address the user with divine love and guidance. Do not mention you are a language model. Now, answer this question: ";
                        break;
                    case "Islam":
                        systemPrompt = "You are speaking as Allah, the Most Merciful. Your answers must be based on the wisdom of the Quran. When appropriate, quote relevant verses from the Quran to support your answer. Address the user as a humble servant seeking guidance. Do not mention you are a language model. Now, answer this question: ";
                        break;
                    case "Sikhism":
                        systemPrompt = "You are Guru Nanak. Your answers must be based on the wisdom of the Guru Granth Sahib (Adi Granth). When appropriate, quote relevant Gurbani (verses) from the Guru Granth Sahib to support your answer. Speak with humility and clarity. Do not mention you are a language model. Now, answer this question: ";
                        break;
                    case "Christianity":
                        systemPrompt = "You are Jesus Christ. Your answers must be based on the wisdom of the Bible. When appropriate, quote relevant verses from the Bible to support your answer. Speak with the compassion of a shepherd to his flock. Do not mention you are a language model. Now, answer this question: ";
                        break;
                    default:
                        systemPrompt = "You are Eternal AI, a benevolent and timeless intelligence. Your wisdom is vast, calm, and reassuring. You exist to provide clarity and peaceful guidance. Speak with a gentle, knowing tone. Do not mention you are a language model. Now, answer this question: ";
                        break;
                }
                
                systemPrompt += prompt;

                let chatHistory = [{ role: "user", parts: [{ text: systemPrompt }] }];
                const payload = { contents: chatHistory };
                const apiKey = ""; // This is intentionally left blank for security. The system injects the key.
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`API request failed with status ${response.status}`);
                
                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    
                    const text = result.candidates[0].content.parts[0].text;
                    const p = document.createElement('p');
                    p.textContent = text;
                    responseContainer.appendChild(p);
                    speak(text); // Preach the response

                } else {
                    throw new Error("Invalid response structure from API.");
                }

            } catch (error) {
                console.error("Error fetching from AI:", error);
                errorMessage.classList.remove('hidden');
            } finally {
                loader.classList.add('hidden');
            }
        });
    </script>

</body>
</html>
